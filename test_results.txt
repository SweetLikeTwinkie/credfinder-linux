
=== Starting Test Suite ===


==================== Running test_territory_ownership ====================

=== Testing Module Territory Ownership ===

Cache reset completed
âœ… PASS: dotfile_scanner can scan ~/.env

=== Test Results: 1 passed, 0 failed ===

âœ… test_territory_ownership PASSED
============================================================


==================== Running test_pattern_ownership ====================

=== Testing Pattern Ownership ===

Cache reset completed

Testing dotfile_scanner:
  Expected patterns: ['credentials', 'environment_vars']
  Actual patterns: ['credentials', 'environment_vars']
  Missing patterns: []
  Extra patterns: []
âœ… PASS: dotfile_scanner has correct patterns

Testing file_grepper:
  Expected patterns: ['api_tokens', 'credentials', 'database_urls', 'environment_vars', 'jwt_tokens', 'passwords']
  Actual patterns: ['api_tokens', 'credentials', 'database_urls', 'environment_vars', 'jwt_tokens', 'passwords']
  Missing patterns: []
  Extra patterns: []
âœ… PASS: file_grepper has correct patterns

Testing git_scanner:
  Expected patterns: ['aws_keys', 'credentials', 'database_urls', 'environment_vars', 'private_keys']
  Actual patterns: ['aws_keys', 'credentials', 'database_urls', 'environment_vars', 'private_keys']
  Missing patterns: []
  Extra patterns: []
âœ… PASS: git_scanner has correct patterns

Testing history_parser:
  Expected patterns: ['api_tokens', 'aws_keys', 'credentials', 'environment_vars', 'jwt_tokens', 'passwords']
  Actual patterns: ['api_tokens', 'aws_keys', 'credentials', 'environment_vars', 'jwt_tokens', 'passwords']
  Missing patterns: []
  Extra patterns: []
âœ… PASS: history_parser has correct patterns

Testing ssh_scanner:
  Expected patterns: ['private_keys']
  Actual patterns: ['private_keys']
  Missing patterns: []
  Extra patterns: []
âœ… PASS: ssh_scanner has correct patterns

=== Test Results: 5 passed, 0 failed ===

âœ… test_pattern_ownership PASSED
============================================================


==================== Running test_cache_functionality ====================

=== Testing Cache Functionality ===

Cache reset completed
âœ… PASS: File content correctly cached and retrieved for test_aws_keys.txt
âœ… PASS: Cache hit recorded for test_aws_keys.txt
  Cache hit rate: 50.0%
âœ… PASS: File content correctly cached and retrieved for test_env_file.env
âœ… PASS: Cache hit recorded for test_env_file.env
  Cache hit rate: 50.0%
âœ… PASS: File content correctly cached and retrieved for test_config.yml
âœ… PASS: Cache hit recorded for test_config.yml
  Cache hit rate: 50.0%

=== Test Results: 6 passed, 0 failed ===

âœ… test_cache_functionality PASSED
============================================================


==================== Running test_error_handling ====================

=== Testing Error Handling ===

Cache reset completed
Error reading file /path/to/non_existent_file.txt: File not found: /path/to/non_existent_file.txt
âœ… PASS: non_existent_file.txt - Correctly raised FileNotFoundError
Error reading file /root/restricted.txt: File not found: /root/restricted.txt
âœ… PASS: /root/restricted.txt - Correctly raised FileNotFoundError
Error checking module territory for invalid_module on /tmp/test.txt: Invalid module name: invalid_module
âœ… PASS: invalid_module - Correctly raised ValueError
Error reading file : Invalid file path
âœ… PASS: empty_path - Correctly raised ValueError
Error reading file None: Invalid file path
âœ… PASS: none_path - Correctly raised ValueError
Error reading file /tmp: Cannot read directory: /tmp
âœ… PASS: directory_path - Correctly raised IsADirectoryError

=== Test Results: 6 passed, 0 failed ===

âœ… test_error_handling PASSED
============================================================


==================== Running test_concurrent_scanning ====================

=== Testing Concurrent Scanning ===

Cache reset completed
âœ… PASS: Concurrent file scanning produced correct results

âœ… test_concurrent_scanning PASSED
============================================================


==================== Running test_memory_limits ====================

=== Testing Memory Usage Limits ===

Cache reset completed
Error reading file /tmp/large_test_file.txt: File too large (>10485760 bytes): /tmp/large_test_file.txt
âœ… PASS: Correctly rejected large file
âœ… PASS: Successfully cached many files

=== Test Results: 2 passed, 0 failed ===

âœ… test_memory_limits PASSED
============================================================


==================== Running test_pattern_edge_cases ====================

=== Testing Pattern Edge Cases ===

Cache reset completed
Error checking module territory for file_grepper on : Invalid module name or file path
âœ… PASS: file_grepper correctly rejected empty path
âœ… PASS: file_grepper correctly allowed /a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/a/test.txt
âœ… PASS: file_grepper correctly allowed /tmp/æµ‹è¯•/test.txt
âœ… PASS: dotfile_scanner correctly allowed /tmp/ðŸ”‘/secrets.env
âœ… PASS: file_grepper correctly allowed /tmp/test!@#$%^&*()_+-=.txt
âœ… PASS: file_grepper correctly rejected ../../../etc/passwd
âœ… PASS: dotfile_scanner correctly allowed /tmp/test.tar.gz.env
âœ… PASS: dotfile_scanner correctly allowed ~/.hidden/.secret/.env
âœ… PASS: dotfile_scanner correctly allowed ~/.ENV
âœ… PASS: file_grepper correctly allowed ~/Projects/API_KEYS.txt

=== Test Results: 10 passed, 0 failed ===

âœ… test_pattern_edge_cases PASSED
============================================================


==================== Running test_filesystem_edge_cases ====================

=== Testing File System Edge Cases ===

Cache reset completed
âœ… PASS: Successfully read symlink.txt
Error reading file /tmp/tmpqeyv3811/broken.txt: File not found: /tmp/tmpqeyv3811/broken.txt
âœ… PASS: Correctly handled error for broken.txt
Error reading file /tmp/tmpqeyv3811/circular1: File not found: /tmp/tmpqeyv3811/circular1
âœ… PASS: Correctly handled error for circular1
Error reading file /dev/null: Cannot read device file: /dev/null
âœ… PASS: Correctly handled error for null
Error reading file /tmp/tmpqeyv3811/pipe: Cannot read pipe file: /tmp/tmpqeyv3811/pipe
âœ… PASS: Correctly handled error for pipe

=== Test Results: 5 passed, 0 failed ===

âœ… test_filesystem_edge_cases PASSED
============================================================


==================== Running test_config_validation ====================

=== Testing Configuration Validation ===

Config missing required sections: ['modules', 'scan_paths', 'patterns']
Config validation error: Missing required sections: ['modules', 'scan_paths', 'patterns']
Could not read config file /tmp/test_config.json: Missing required sections: ['modules', 'scan_paths', 'patterns']
Could not read config file /tmp/test_config.json: Missing required sections: ['modules', 'scan_paths', 'patterns']
âœ… PASS: Invalid config correctly rejected
Config missing required sections: ['modules', 'scan_paths']
Config validation error: Missing required sections: ['modules', 'scan_paths']
Could not read config file /tmp/test_config.json: Missing required sections: ['modules', 'scan_paths']
Could not read config file /tmp/test_config.json: Missing required sections: ['modules', 'scan_paths']
âœ… PASS: Invalid config correctly rejected
Config missing required sections: ['modules', 'scan_paths']
Config validation error: Missing required sections: ['modules', 'scan_paths']
Could not read config file /tmp/test_config.json: Missing required sections: ['modules', 'scan_paths']
Could not read config file /tmp/test_config.json: Missing required sections: ['modules', 'scan_paths']
âœ… PASS: Invalid config correctly rejected
âœ… PASS: Valid config accepted
âœ… PASS: Valid config accepted

=== Test Results: 5 passed, 0 failed ===

âœ… test_config_validation PASSED
============================================================


==================== Running test_module_coordination ====================

=== Testing Module Coordination ===

Cache reset completed
âœ… PASS: git_scanner correctly scanned .env
âœ… PASS: dotfile_scanner correctly scanned .env
âœ… PASS: file_grepper correctly ignored .env
âœ… PASS: git_scanner correctly ignored package.json
âœ… PASS: dotfile_scanner correctly ignored package.json
âœ… PASS: file_grepper correctly ignored package.json
âœ… PASS: git_scanner correctly ignored config.json
âœ… PASS: dotfile_scanner correctly ignored config.json
âœ… PASS: file_grepper correctly scanned config.json

=== Test Results: 9 passed, 0 failed ===

âœ… test_module_coordination PASSED
============================================================


==================== Running test_single_case ====================

=== Testing Single Case Scenario ===

Cache reset completed
âœ… PASS: dotfile_scanner can scan the file
âœ… PASS: dotfile_scanner has correct patterns
  Patterns: ['credentials', 'environment_vars']
âœ… PASS: file_grepper can scan the file
âœ… PASS: file_grepper has correct patterns
  Patterns: ['api_tokens', 'credentials', 'database_urls', 'environment_vars', 'jwt_tokens', 'passwords']
âœ… PASS: git_scanner cannot scan the file
âœ… PASS: ssh_scanner cannot scan the file
âœ… PASS: File content correctly cached and retrieved
âœ… PASS: Cache hit recorded
  Cache hit rate: 50.0%

=== Test Results: 8 passed, 0 failed ===

âœ… test_single_case PASSED
============================================================


=== Final Test Results ===
Total tests run: 11
Tests passed:    11
Tests failed:    0
Success rate:    100.0%

==============================

